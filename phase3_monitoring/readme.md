# üîê Enterprise Cybersecurity & DevSecOps Environment Lab ‚Äì Phase 3: Monitoring and Visibility

## üß© Overview

In Phase 3, we introduce centralized **monitoring, alerting, and visibility** to our infrastructure by deploying a dedicated **Monitoring VM**. This phase is essential for detecting attacks, system anomalies, and suspicious behaviors that went unnoticed in previous stages.

This monitoring stack simulates what real Security Operations Centers (SOCs) use in production environments.

---

## üß± Virtual Machines Used

| VM Name           | Role                     | Description                                                             |
|-------------------|--------------------------|-------------------------------------------------------------------------|
| **Monitoring VM** | SIEM + Metrics Collection| Hosts the core monitoring tools: **Wazuh**, **ELK Stack**, **Prometheus**, **Grafana**, and optionally **Splunk**. |

> This VM resides in the **internal network** and has access to all internal systems (App VM, IAM VM, DMZ), but is **not externally accessible**.

---

## üõ†Ô∏è Services Setup

### ‚úÖ Core Tools (Must-Have)
- **Wazuh** (SIEM)
  - Collects and analyzes logs from all connected agents
  - Detects brute-force, port scanning, privilege escalation, file changes, and more
- **ELK Stack**
  - **Elasticsearch**: stores structured logs and alerts
  - **Logstash / Filebeat**: ingests data from Wazuh and systems
  - **Kibana**: provides dashboards and visualizations for logs and alerts

### üåü Optional (Advanced)
- **Prometheus**
  - Scrapes metrics (CPU, memory, etc.) from all internal VMs
- **Grafana**
  - Visualizes metrics from Prometheus in rich, customizable dashboards
- **Splunk (Optional)**
  - Can be added for advanced log correlation or for comparing open-source vs commercial tools

---

## üß± Agent Configuration

| VM               | Agent Installed          | Logs Collected                                    |
|------------------|--------------------------|--------------------------------------------------|
| **Internal App VM** | Wazuh agent + Node exporter | System logs, process monitoring, CPU/memory usage |
| **IAM VM (Keycloak)** | Wazuh agent             | Auth events, login attempts, config changes       |
| **DMZ VM**        | Wazuh agent + Node exporter | SSH login attempts, NGINX access logs            |

All agents forward logs to the **Wazuh Manager**, which sends data to **Elasticsearch** and makes it available in **Kibana**.

---

## üéØ Phase Goals

By the end of this phase, we will have:

- A fully functioning **SIEM solution** (Wazuh + ELK)
- System metrics monitoring with **Prometheus + Grafana**
- All VMs reporting logs and metrics to the Monitoring VM
- Sample alerts generated by:
  - SSH brute-force attempts
  - Web scans and failed logins
  - Unauthorized file modifications
- A central dashboard (Kibana/Grafana) for visibility into the environment

---

## üß™ Testing Scenarios

- Use the Kali VM to:
  - Run `nmap` and `nikto` scans against DMZ and App VMs
  - Simulate brute-force SSH logins using `hydra`
  - Tamper with files (e.g., `/etc/passwd`) on monitored hosts
- Observe real-time alerts in Wazuh dashboard (via Kibana)
- Review CPU/memory usage trends in Grafana
- (Optional) Send logs to Splunk and compare alerting behavior

---

## üîí Security Design

- Wazuh Manager accepts logs only from authenticated agents
- Elasticsearch is **local-only** (not exposed to external IPs)
- Kibana, Grafana, and Prometheus are accessible only from the DMZ or jump host
- Alerts can be configured to trigger emails, log events, or integrate with future SOAR tools

---

## ‚úÖ Next Step

In **Phase 4**, we will focus on **simulating attacks** using the Kali machine, documenting their traces in the monitoring tools, and writing detection rules and response actions based on the alerts.

